<form [formGroup]="migrationForm" *ngIf="migrationForm">
  <ng-container
    formArrayName="migration_details"
    *ngFor="let migration of migrationFormArray.controls; let i = index"
  >
    <div [formGroupName]="i">
      <app-accordion
        [title]="getMigrationName(i)"
        (remove)="removeMigration(getMigrationId(i), i)"
      >
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-4">
          <div class="form-group">
            <label>Migration Date</label>
            <input
              type="date"
              formControlName="migrated_on"
              class="lg:col-span-2"
            />
          </div>
          <div class="form-group">
            <label>Comment</label>
            <input
              type="text"
              formControlName="comment"
              class="lg:col-span-2"
            />
          </div>
          <div class="form-group">
            <label>Parish</label>
            <input type="text" formControlName="parish" class="lg:col-span-2" />
          </div>
          <div class="form-group">
            <label>Return Date</label>
            <input
              type="date"
              formControlName="return_date"
              class="lg:col-span-2"
            />
          </div>
          <div class="form-group">
            <label>Address</label>
            <input
              type="text"
              formControlName="address"
              class="lg:col-span-2"
            />
          </div>
          <!-- Place section -->
          <app-section-form [title]="'Place'" class="md:col-span-3">
            <div class="form-section-3" formGroupName="place">
              <!-- City -->
              <div class="form-group">
                <label>City</label>
                <input
                  type="text"
                  formControlName="city"
                  class="lg:col-span-2"
                />
              </div>
              <!-- State -->
              <div class="form-group">
                <label>State</label>
                <input
                  type="text"
                  formControlName="state"
                  class="lg:col-span-2"
                />
              </div>
              <!-- Country -->
              <div class="form-group">
                <label>Country</label>
                <input
                  type="text"
                  formControlName="country"
                  class="lg:col-span-2"
                />
              </div>
            </div>
          </app-section-form>
        </div>

        <!-- Action section -->
        <footer
          class="side-tab-footer w-full mt-4 p-2 flex justify-end items-center border-t-gray-200 border-t-2"
          *appCanEdit="screen"
        >
          <ng-container *ngIf="migrationFormArray.length > i">
            <button class="mr-2" (click)="save(getMigrationId(i), i)">
              <fa-icon [icon]="faFloppyDisk"></fa-icon> Save
            </button>
          </ng-container>
        </footer>
      </app-accordion>
    </div>
  </ng-container>
</form>
<span *appCanCreate="screen">
  <button
    class="accordion-btn border-1 border-primary-color hover:border-none justify-center"
    (click)="addMigration()"
  >
    <fa-icon [icon]="faPlus"></fa-icon> Add Migration
  </button>
</span>
